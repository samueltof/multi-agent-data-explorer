example_input_question,example_output_query
"How many TCR complexes are in the database?","SELECT COUNT(*) AS total_complexes FROM complexes;"
"What are all the unique epitope sequences?","SELECT DISTINCT antigen_epitope FROM complexes ORDER BY antigen_epitope;"
"Show all chains (cdr3 + gene) for complex ID 0.","SELECT gene, cdr3 FROM chains WHERE complex_id = 0;"
"How many alpha vs beta chains do we have in total?","SELECT gene, COUNT(*) AS chain_count FROM chains GROUP BY gene;"
"For each epitope, how many distinct complexes recognize it?","SELECT antigen_epitope, COUNT(DISTINCT complex_id) AS complexes_count FROM complexes GROUP BY antigen_epitope ORDER BY complexes_count DESC;"
"What is the average CDR3 length (number of AAs) per chain type?","SELECT gene, AVG(LENGTH(cdr3)) AS avg_cdr3_length FROM chains GROUP BY gene;"
"Extract cell subset from the JSON meta in complexes and count per subset","SELECT json_extract(meta, '$.\"cell.subset\"') AS cell_subset, COUNT(*) AS num_complexes FROM complexes GROUP BY cell_subset HAVING cell_subset IS NOT NULL;"
"Find the top 5 epitopes by average VDJdb score across their chains","SELECT c.antigen_epitope, AVG(ch.vdjdb_score) AS avg_score FROM complexes AS c JOIN chains AS ch USING (complex_id) GROUP BY c.antigen_epitope ORDER BY avg_score DESC LIMIT 5;"
"List complexes where both alpha and beta chains come from the same V-gene family","WITH v_families AS (SELECT complex_id, SUBSTR(v_segm, 1, INSTR(v_segm, '*') - 1) AS v_family, COUNT(DISTINCT gene) AS chain_types FROM chains GROUP BY complex_id, v_family) SELECT c.complex_id, vf.v_family FROM v_families AS vf JOIN complexes AS c ON c.complex_id = vf.complex_id WHERE vf.chain_types = 2;"
"Distribution of CDR3 lengths for beta chains targeting the 'GILGFVFTL' epitope","SELECT LENGTH(ch.cdr3) AS cdr3_length, COUNT(*) AS count FROM chains AS ch JOIN complexes AS c USING (complex_id) WHERE ch.gene = 'TRB' AND c.antigen_epitope = 'GILGFVFTL' GROUP BY cdr3_length ORDER BY cdr3_length;"
"Correlate reported frequency from method JSON to chain counts","WITH freq_data AS (SELECT complex_id, CAST(REPLACE(json_extract(method, '$.frequency'), '%', '') AS REAL) AS freq_pct FROM complexes WHERE json_type(json_extract(method, '$.frequency')) = 'text') SELECT f.freq_pct, COUNT(ch.chain_id) AS total_chains FROM freq_data AS f JOIN chains AS ch USING (complex_id) GROUP BY f.freq_pct ORDER BY f.freq_pct DESC;"
"Which chains have CDR3 length greater than 14?","SELECT chain_id, gene, cdr3, LENGTH(cdr3) AS len FROM chains WHERE LENGTH(cdr3) > 14;"
"Find complexes with V gene TRBV19*01 in any chain.","SELECT DISTINCT complex_id FROM chains WHERE v_segm = 'TRBV19*01';"
"List all complexes where subject.cohort is 'MA-EBV-SN'.","SELECT complex_id FROM complexes WHERE json_extract(meta, '$.\"subject.cohort\"') = 'MA-EBV-SN';"
"Count the number of complexes per subject ID.","SELECT json_extract(meta, '$.\"subject.id\"') AS subject_id, COUNT(*) AS complex_count FROM complexes GROUP BY subject_id;"
"What is the average vdjdb_score per MHC class?","SELECT c.mhc_class, AVG(ch.vdjdb_score) AS avg_score FROM complexes AS c JOIN chains AS ch USING (complex_id) GROUP BY c.mhc_class;"
"Find chains where the CDR3fix JSON has fixNeeded = true.","SELECT chain_id, gene, cdr3 FROM chains WHERE json_extract(cdr3fix, '$.fixNeeded') = 1;"
"Which epitopes have more than 10 associated chains?","SELECT antigen_epitope, COUNT(*) AS chain_count FROM complexes AS c JOIN chains AS ch USING (complex_id) GROUP BY antigen_epitope HAVING chain_count > 10;"
"List the top 3 V gene segments by usage frequency.","SELECT v_segm, COUNT(*) AS usage_count FROM chains GROUP BY v_segm ORDER BY usage_count DESC LIMIT 3;"
"Show the number of chains per antigen epitope.","SELECT c.antigen_epitope, COUNT(ch.chain_id) AS num_chains FROM complexes AS c JOIN chains AS ch USING (complex_id) GROUP BY c.antigen_epitope;"
"For complexes targeting 'GILGFVFTL', show distribution of samples.found from meta.","SELECT json_extract(meta, '$.\"samples.found\"') AS samples_found, COUNT(*) AS count FROM complexes WHERE antigen_epitope = 'GILGFVFTL' GROUP BY samples_found;"
"Show the total number of T cell clones by chain type","SELECT gene AS chain_type, COUNT(DISTINCT complex_id) AS total_clones FROM chains GROUP BY gene;"
"Find high-confidence chains (vdjdb_score â‰¤ 2) and their V/J gene usage","SELECT chain_id, v_segm, j_segm, vdjdb_score FROM chains WHERE vdjdb_score <= 2 ORDER BY vdjdb_score;"
"Get the distribution of chain types across all chains","SELECT gene AS chain_type, COUNT(*) AS count FROM chains GROUP BY gene;"
"Count unique CDR3 sequences per species for alpha chains","SELECT species, COUNT(DISTINCT cdr3) AS unique_sequences FROM chains WHERE gene = 'TRA' GROUP BY species;"
"Show the top 10 V gene segments by usage","SELECT v_segm, COUNT(*) AS usage_count FROM chains GROUP BY v_segm ORDER BY usage_count DESC LIMIT 10;"
"What is the distribution of MHC classes in the dataset?","SELECT mhc_class, COUNT(*) AS count FROM complexes GROUP BY mhc_class;"
"Show epitope species distribution","SELECT antigen_species, COUNT(*) AS count FROM complexes GROUP BY antigen_species;"
"Compare V gene usage between different epitope species","SELECT c.antigen_species, ch.v_segm, COUNT(*) AS usage_count FROM complexes AS c JOIN chains AS ch USING (complex_id) GROUP BY c.antigen_species, ch.v_segm ORDER BY usage_count DESC;"
"Get summary statistics of CDR3 length for beta chains","SELECT MIN(LENGTH(cdr3)) AS min_len, AVG(LENGTH(cdr3)) AS avg_len, MAX(LENGTH(cdr3)) AS max_len FROM chains WHERE gene = 'TRB';"
"Find the number of high-confidence chains per epitope","SELECT c.antigen_epitope, COUNT(*) AS high_confidence_chains FROM complexes AS c JOIN chains AS ch USING (complex_id) WHERE ch.vdjdb_score <= 2 GROUP BY c.antigen_epitope ORDER BY high_confidence_chains DESC;"
